"use strict";(()=>{var e={};e.id=2572,e.ids=[2572],e.modules={2418:e=>{e.exports=require("mysql2/promise")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,s){return s in t?t[s]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,s)):"function"==typeof t&&"default"===s?t:void 0}}})},56:(e,t,s)=>{s.r(t),s.d(t,{config:()=>m,default:()=>u,routeModule:()=>d});var a={};s.r(a),s.d(a,{default:()=>l});var o=s(1802),n=s(7153),r=s(6249),i=s(1004);async function l(e,t){let{id:s}=e.query;if(!s||isNaN(s))return t.status(400).json({message:"Invalid ID"});if("PUT"===e.method)try{let{name:a,attributes:o,talent1:n,talent2:r,talent3:l}=e.body;if(!a)return t.status(400).json({message:"Name is required"});let u=await (0,i.I)(`
        UPDATE emblems 
        SET emblem_name = ?, attributes = ?, talent_slot1_options = ?, talent_slot2_options = ?, talent_slot3_options = ?
        WHERE id = ?
      `,[a,o||"",n||"",r||"",l||"",s]);if(0===u.affectedRows)return t.status(404).json({message:"Emblem not found"});t.status(200).json({id:parseInt(s),name:a,attributes:o,talent1:n,talent2:r,talent3:l})}catch(e){console.error("Error updating emblem:",e),t.status(500).json({message:"Failed to update emblem"})}else if("DELETE"===e.method)try{let e=await (0,i.I)("DELETE FROM emblems WHERE id = ?",[s]);if(0===e.affectedRows)return t.status(404).json({message:"Emblem not found"});t.status(200).json({message:"Emblem deleted successfully"})}catch(e){console.error("Error deleting emblem:",e),t.status(500).json({message:"Failed to delete emblem"})}else if("GET"===e.method)try{let e=await (0,i.I)(`
        SELECT 
          id,
          emblem_name as name, 
          attributes,
          talent_slot1_options as talent1,
          talent_slot2_options as talent2,
          talent_slot3_options as talent3
        FROM emblems 
        WHERE id = ?
      `,[s]);if(0===e.length)return t.status(404).json({message:"Emblem not found"});t.status(200).json(e[0])}catch(e){console.error("Error fetching emblem:",e),t.status(500).json({message:"Failed to fetch emblem"})}else t.status(405).json({message:"Method not allowed"})}let u=(0,r.l)(a,"default"),m=(0,r.l)(a,"config"),d=new o.PagesAPIRouteModule({definition:{kind:n.x.PAGES_API,page:"/api/emblems/[id]",pathname:"/api/emblems/[id]",bundlePath:"",filename:""},userland:a})},1004:(e,t,s)=>{let a;s.d(t,{I:()=>i,db:()=>r});var o=s(2418),n=s.n(o);async function r(){if(!a){let{DB_HOST:e="localhost",DB_NAME:t="",DB_USER:s="",DB_PASS:o="",DB_PORT:r="3306"}=process.env;try{a=n().createPool({host:e,port:Number(r),user:s,password:o,database:t,connectionLimit:10,charset:"utf8mb4_unicode_ci",acquireTimeout:6e4,timeout:6e4,enableKeepAlive:!0,keepAliveInitialDelay:0})}catch(e){throw console.error("Failed to create database pool:",e),Error("Database connection failed")}}return a}async function i(e,t=[]){try{let s=await r(),[a]=await s.execute(e,t);return a}catch(e){throw console.error("Database query failed:",e),e}}},7153:(e,t)=>{var s;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return s}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(s||(s={}))},1802:(e,t,s)=>{e.exports=s(145)}};var t=require("../../../webpack-api-runtime.js");t.C(e);var s=t(t.s=56);module.exports=s})();