(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[763],{8886:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/edit-hero-attributes",function(){return a(2740)}])},2740:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return i}});var r=a(5893),n=a(7294),l=a(1163);let s=[{key:"hp",label:"HP",type:"number"},{key:"physical_attack",label:"Physical Attack",type:"number"},{key:"mana",label:"Mana",type:"number"},{key:"magic_power",label:"Magic Power",type:"number"},{key:"physical_defense",label:"Physical Defense",type:"number"},{key:"physical_defense_pct",label:"Physical Defense %",type:"number",step:"0.01"},{key:"attack_speed",label:"Attack Speed",type:"number",step:"0.01"},{key:"crit_chance",label:"Crit Chance %",type:"number",step:"0.01"},{key:"magic_defense",label:"Magic Defense",type:"number"},{key:"magic_defense_pct",label:"Magic Defense %",type:"number",step:"0.01"},{key:"cd_reduction",label:"Cooldown Reduction %",type:"number",step:"0.01"},{key:"movement_speed",label:"Movement Speed",type:"number"},{key:"hp_regen",label:"HP Regen",type:"number",step:"0.01"},{key:"mana_regen",label:"Mana Regen",type:"number",step:"0.01"},{key:"physical_penetration",label:"Physical Penetration",type:"number"},{key:"physical_penetration_pct",label:"Physical Penetration %",type:"number",step:"0.01"},{key:"magic_penetration",label:"Magic Penetration",type:"number"},{key:"magic_penetration_pct",label:"Magic Penetration %",type:"number",step:"0.01"},{key:"lifesteal",label:"Lifesteal %",type:"number",step:"0.01"},{key:"spell_vamp",label:"Spell Vamp %",type:"number",step:"0.01"},{key:"basic_attack_range",label:"Basic Attack Range",type:"number",step:"0.01"},{key:"resilience",label:"Resilience",type:"number"},{key:"crit_damage",label:"Crit Damage",type:"number"},{key:"healing_effect",label:"Healing Effect %",type:"number",step:"0.01"},{key:"crit_damage_reduction",label:"Crit Damage Reduction %",type:"number",step:"0.01"},{key:"healing_received",label:"Healing Received %",type:"number",step:"0.01"}];function i(){let e=(0,l.useRouter)(),t="string"==typeof e.query.name?e.query.name:"",[a,i]=(0,n.useState)(!1),[c,o]=(0,n.useState)(!1),[m,u]=(0,n.useState)(""),[p,d]=(0,n.useState)(""),[b,y]=(0,n.useState)(()=>Object.fromEntries(s.map(e=>[e.key,""]))),h=(0,n.useMemo)(()=>!!b&&s.some(e=>{let t=b[e.key];return""!==t&&null!=t}),[b]),[g,f]=(0,n.useState)(""),[x,k]=(0,n.useState)([]),[w,_]=(0,n.useState)(-1),[v,j]=(0,n.useState)(!1),N=(0,n.useRef)(null),E=(0,n.useRef)(null);(0,n.useEffect)(()=>{if(!t){y(Object.fromEntries(s.map(e=>[e.key,""])));return}f(t),j(!1),i(!0),u(""),d(""),fetch("/api/heroes/".concat(encodeURIComponent(t),"/attributes")).then(async e=>{if(404===e.status)return Object.fromEntries(s.map(e=>[e.key,""]));if(!e.ok){let t=await e.text().catch(()=>"");throw Error("Gagal memuat (".concat(e.status,") ").concat(t))}return e.json()}).then(e=>y({...Object.fromEntries(s.map(e=>[e.key,""])),...e})).catch(e=>u(e.message||"Error")).finally(()=>i(!1))},[t]);let[P,S]=(0,n.useState)("");(0,n.useEffect)(()=>{let e=setTimeout(()=>S(g),300);return()=>clearTimeout(e)},[g]),(0,n.useEffect)(()=>{let e=!1;return(async()=>{let t=P.trim();if(!t||!v){k([]),_(-1);return}try{let a=await fetch("/api/heroes_search?q=".concat(encodeURIComponent(t)));if(!a.ok)throw Error("Network error");let r=await a.json();e||k(Array.isArray(r)?r:[])}catch(e){console.error(e)}})(),()=>{e=!0}},[P,v]);let C=t=>{k([]),_(-1),e.push({pathname:"/edit-hero-attributes",query:{name:t}},void 0,{shallow:!1})};(0,n.useEffect)(()=>{let e=e=>{N.current&&!N.current.contains(e.target)&&e.target!==E.current&&k([])};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[]);let D=(e,t)=>{y(a=>({...a,[e]:t}))},M=async e=>{if(e.preventDefault(),t){o(!0),u(""),d("");try{let e={};if(s.forEach(t=>{let a=b[t.key];void 0!==a&&(e[t.key]=a)}),!(await fetch("/api/heroes/".concat(encodeURIComponent(t),"/attributes"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok)throw Error("Gagal menyimpan perubahan");d("Perubahan berhasil disimpan");try{let e=await fetch("/api/heroes/".concat(encodeURIComponent(t),"/attributes"));if(e.ok){let t=await e.json();y(e=>({...e,...t}))}}catch(e){}}catch(e){u(e.message||"Error")}finally{o(!1)}}};return(0,r.jsx)("main",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-white to-blue-50",children:(0,r.jsxs)("div",{className:"max-w-3xl mx-auto px-4 py-8",children:[(0,r.jsxs)("header",{className:"mb-6 flex items-center justify-between",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Edit Hero Attributes"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("a",{href:"/",className:"text-sm inline-flex items-center gap-1 px-3 py-1.5 rounded-md border border-gray-200 text-gray-700 bg-white hover:bg-gray-100",children:"Heroes"}),(0,r.jsx)("a",{href:"/edit-matches",className:"text-sm inline-flex items-center gap-1 px-3 py-1.5 rounded-md border border-gray-200 text-gray-700 bg-white hover:bg-gray-100",children:"Matches"}),(0,r.jsx)("a",{href:"/",className:"text-sm inline-flex items-center gap-1 px-3 py-1.5 rounded-md border border-gray-200 text-gray-700 bg-white hover:bg-gray-100",children:"Home"})]})]}),(0,r.jsxs)("section",{className:"bg-white rounded-2xl shadow border border-gray-100 p-4 md:p-6",children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pilih Hero"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{id:"heroAttrInput",ref:E,value:g,onChange:e=>{f(e.target.value),_(-1),j(!0)},onKeyDown:e=>{if(x.length)switch(e.key){case"ArrowDown":e.preventDefault(),_(e=>(e+1)%x.length);break;case"ArrowUp":e.preventDefault(),_(e=>(e-1+x.length)%x.length);break;case"Enter":w>=0&&(e.preventDefault(),C(x[w]));break;case"Escape":k([])}},placeholder:"Ketik nama hero...",className:"w-full rounded-md border border-gray-300 bg-white focus:border-black focus:ring-black px-3 py-2",autoComplete:"off"}),x.length>0&&(0,r.jsx)("div",{ref:N,className:"absolute z-10 mt-2 w-full bg-white border border-gray-200 rounded-xl shadow-lg max-h-72 overflow-auto",children:x.map((e,t)=>(0,r.jsx)("div",{className:"cursor-pointer px-4 py-2 text-sm text-gray-700 ".concat(0===t?"rounded-t-xl":""," ").concat(t===x.length-1?"rounded-b-xl":""," ").concat(t===w?"bg-gray-100":""),onMouseDown:t=>{t.preventDefault(),C(e)},children:e},e+t))})]}),t&&(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Sedang mengedit atribut: ",(0,r.jsx)("span",{className:"font-medium",children:t})]})]}),a&&(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Memuat data..."}),m&&(0,r.jsx)("p",{className:"text-sm text-red-600",children:m}),p&&(0,r.jsx)("p",{className:"text-sm text-green-600",children:p}),!a&&!m&&t&&!h&&(0,r.jsx)("div",{className:"mt-2 rounded-md bg-yellow-50 border border-yellow-200 text-yellow-800 text-sm px-3 py-2",children:'Data attributes untuk hero ini belum ada. Silakan isi form di bawah lalu klik "Simpan Perubahan".'}),(0,r.jsxs)("form",{onSubmit:M,className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.map(e=>{let t=b&&void 0!==b[e.key]&&null!==b[e.key]?b[e.key]:"";return(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:e.label}),(0,r.jsx)("input",{type:e.type||"text",step:e.step||void 0,value:t,onChange:t=>D(e.key,t.target.value),className:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 focus:border-black focus:ring-black",placeholder:"Masukkan ".concat(e.label.toLowerCase(),"...")})]},e.key)}),(0,r.jsx)("div",{className:"md:col-span-2 pt-2",children:(0,r.jsx)("button",{type:"submit",disabled:c,className:"inline-flex items-center gap-2 px-4 py-2 rounded-md bg-purple-600 text-white hover:bg-purple-700 disabled:opacity-50",children:c?"Menyimpan...":"Simpan Perubahan"})})]})]})]})})}},1163:function(e,t,a){e.exports=a(9090)}},function(e){e.O(0,[888,774,179],function(){return e(e.s=8886)}),_N_E=e.O()}]);