(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[416],{6031:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/items-swr-refactored",function(){return a(6326)}])},6326:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return g}});var s=a(5893),n=a(7294),r=a(5068),l=a(1163),i=a(9008),o=a.n(i);a(1664);var c=a(2255),d=a(7134);let u=async e=>{let t=await fetch(e);if(!t.ok){let e=Error("An error occurred while fetching the data.");throw e.info=await t.json(),e.status=t.status,e}return t.json()},m="/api",x="".concat(m,"/search"),h="".concat(m,"/items");function g(){let e=(0,l.useRouter)(),[t,a]=(0,n.useState)(""),[i,m]=(0,n.useState)(!1),[g,p]=(0,n.useState)(-1),[f,b]=(0,n.useState)(!1),[j,v]=(0,n.useState)(""),y=(0,n.useRef)(null),w=(0,n.useRef)(null);(0,n.useEffect)(()=>{let e=setTimeout(()=>{v(t)},300);return()=>clearTimeout(e)},[t]);let{data:N,error:k,isLoading:_}=(0,r.ZP)(j.length>0?"".concat(x,"?q=").concat(encodeURIComponent(j)):null,u,{revalidateOnFocus:!1,dedupingInterval:1e3}),C=(0,n.useMemo)(()=>N&&N.suggestions||[],[N]),{data:M,error:E,size:I,setSize:D,isLoading:R,isValidating:S}=(0,r.useSWRInfinite)(e=>"".concat(h,"?page=").concat(e+1,"&limit=12"),u,{revalidateOnFocus:!1,revalidateFirstPage:!1}),F=(0,n.useMemo)(()=>M?M.flatMap(e=>e.items||[]):[],[M]),L=(0,n.useMemo)(()=>{var e;if(!M||0===M.length)return!1;let t=M[M.length-1];return!1!==t.hasMore&&(null===(e=t.items)||void 0===e?void 0:e.length)>0},[M]),T=S&&I>0,O=0===F.length&&!R,P=a=>{a.preventDefault(),t.trim()&&e.push("/item/".concat(encodeURIComponent(t.trim())))},U=t=>{a(t),b(!1),e.push("/item/".concat(encodeURIComponent(t)))};return(0,n.useEffect)(()=>{if(!w.current||!L)return;let e=new IntersectionObserver(e=>{e[0].isIntersecting&&!T&&D(I+1)},{threshold:.1});return e.observe(w.current),()=>e.disconnect()},[L,T,I,D]),(0,n.useEffect)(()=>{let e=e=>{y.current&&!y.current.contains(e.target)&&b(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,s.jsxs)(c.Z,{children:[(0,s.jsxs)(o(),{children:[(0,s.jsx)("title",{children:"Items - ML Helper"}),(0,s.jsx)("meta",{name:"description",content:"Cari dan jelajahi items di database ML Helper"}),(0,s.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-green-50",children:(0,s.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-6xl",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("h1",{className:"text-3xl md:text-4xl font-bold text-gray-800 mb-2",children:"Items Database"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Cari atau jelajahi semua items yang tersedia"})]}),(0,s.jsx)("div",{className:"flex justify-center mb-6",children:(0,s.jsxs)("div",{className:"bg-white rounded-full shadow-md p-1 flex",children:[(0,s.jsx)("button",{onClick:()=>m(!1),className:"px-6 py-2 rounded-full text-sm font-medium transition-all ".concat(i?"text-gray-600 hover:text-gray-800":"bg-blue-600 text-white"),children:"Pencarian"}),(0,s.jsx)("button",{onClick:()=>m(!0),className:"px-6 py-2 rounded-full text-sm font-medium transition-all ".concat(i?"bg-blue-600 text-white":"text-gray-600 hover:text-gray-800"),children:"Semua Items"})]})}),!i&&(0,s.jsxs)("section",{className:"bg-white rounded-2xl shadow border border-gray-100 p-4 md:p-6 mb-6",children:[(0,s.jsx)("form",{onSubmit:P,children:(0,s.jsxs)("div",{className:"relative",ref:y,children:[(0,s.jsx)("input",{type:"text",value:t,onChange:e=>{let t=e.target.value;a(t),p(-1),b(t.length>0)},onKeyDown:e=>{if(f&&0!==C.length)switch(e.key){case"ArrowDown":e.preventDefault(),p(e=>(e+1)%C.length);break;case"ArrowUp":e.preventDefault(),p(e=>(e-1+C.length)%C.length);break;case"Enter":e.preventDefault(),g>=0&&g<C.length?U(C[g]):P(e);break;case"Escape":b(!1),p(-1)}},onFocus:()=>b(t.length>0),placeholder:"Ketik nama item...",className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",autoComplete:"off"}),(0,s.jsx)("button",{type:"submit",className:"absolute right-2 top-1/2 transform -translate-y-1/2 bg-blue-600 text-white p-2 rounded-lg hover:bg-blue-700 transition-colors",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"})})}),f&&t.length>0&&(0,s.jsx)("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-xl shadow-lg max-h-60 overflow-y-auto",children:_?(0,s.jsxs)("div",{className:"flex items-center justify-center py-3",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-green-600"}),(0,s.jsx)("span",{className:"ml-2 text-sm text-gray-600",children:"Mencari items..."})]}):C.length>0?C.map((e,t)=>(0,s.jsx)("div",{className:"cursor-pointer px-4 py-2 text-sm text-gray-700 ".concat(0===t?"rounded-t-xl":""," ").concat(t===C.length-1?"rounded-b-xl":""," ").concat(t===g?"bg-gray-100":""),onMouseDown:t=>{t.preventDefault(),U(e)},children:e},e+t)):(0,s.jsxs)("div",{className:"px-4 py-3 text-sm text-gray-500",children:['Tidak ada hasil untuk "',t,'"']})})]})}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"Mulai ketik minimal 1 huruf. Gunakan tombol panah untuk navigasi dan Enter untuk pilih."})]}),i&&(0,s.jsx)("section",{className:"bg-white rounded-2xl shadow border border-gray-100 p-4 md:p-6",children:R?(0,s.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-sky-600"}),(0,s.jsx)("span",{className:"ml-2 text-gray-600",children:"Memuat items..."})]}):O?(0,s.jsx)("div",{className:"text-center py-12",children:(0,s.jsx)("p",{className:"text-gray-600",children:"Tidak ada items ditemukan di database."})}):F.length>0?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:F.map((t,a)=>(0,s.jsx)("div",{className:"bg-gray-50 rounded-lg p-4 hover:bg-gray-100 transition-colors cursor-pointer border border-gray-200",onClick:()=>e.push("/item/".concat(encodeURIComponent(t.item_name))),children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(d.Z,{src:t.image_url,alt:t.item_name,containerClassName:"w-16 h-16 mx-auto mb-3",className:"w-full h-full object-cover rounded-full"}),(0,s.jsx)("h3",{className:"font-semibold text-gray-900 text-sm mb-1",children:t.item_name}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:t.category||"Item"})]})},a))}),(0,s.jsxs)("div",{ref:w,className:"mt-8 flex flex-col items-center justify-center py-4",children:[T&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"}),(0,s.jsx)("span",{className:"mt-2 text-sm text-gray-600",children:"Memuat lebih banyak items..."})]}),!L&&F.length>0&&(0,s.jsxs)("div",{className:"text-sm text-gray-500",children:["âœ“ Semua ",F.length," items telah dimuat"]})]})]}):null}),(0,s.jsxs)("footer",{className:"mt-10 text-center text-xs text-gray-400",children:[new Date().getFullYear()," ML Helper"]})]})})]})}},9008:function(e,t,a){e.exports=a(7828)}},function(e){e.O(0,[424,42,888,774,179],function(){return e(e.s=6031)}),_N_E=e.O()}]);