"use strict";(()=>{var e={};e.id=7939,e.ids=[7939],e.modules={2418:e=>{e.exports=require("mysql2/promise")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,o){return o in t?t[o]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,o)):"function"==typeof t&&"default"===o?t:void 0}}})},2753:(e,t,o)=>{o.r(t),o.d(t,{config:()=>i,default:()=>u,routeModule:()=>m});var a={};o.r(a),o.d(a,{default:()=>l});var s=o(1802),n=o(7153),r=o(6249),c=o(1004);async function l(e,t){if("GET"!==e.method)return t.status(405).json({message:"Method not allowed"});try{console.log("Attempting to connect to database..."),console.log("DB Config:",{host:process.env.DB_HOST,port:process.env.DB_PORT,database:process.env.DB_NAME,user:process.env.DB_USER});let e=await (0,c.db)(),o=[];try{let[t]=await e.execute("SHOW TABLES");o=t,console.log("Available tables:",o.map(e=>Object.values(e)[0]))}catch(e){console.log("SHOW TABLES failed (non-fatal):",e.message)}let a=0,s=0,n=0,r=0,l=0;try{let[t]=await e.execute("SELECT COUNT(*) as count FROM heroes");a=Number(t[0]?.count)||0,console.log("Heroes count:",a)}catch(e){console.log("Heroes table error:",e.message)}try{let[t]=await e.execute("SELECT COUNT(*) as count FROM items");s=Number(t[0]?.count)||0,console.log("Items count:",s)}catch(e){console.log("Items table error:",e.message)}try{let[t]=await e.execute("SELECT COUNT(*) as count FROM matches");n=Number(t[0]?.count)||0,console.log("Matches count:",n)}catch(e){console.log("Matches table error:",e.message)}try{let[t]=await e.execute("SELECT COUNT(*) as count FROM teams");r=Number(t[0]?.count)||0,console.log("Teams count:",r)}catch(e){console.log("Teams table error:",e.message)}try{let[t]=await e.execute(`
        SELECT COUNT(*) as count
        FROM heroes
        WHERE created_at >= DATE_SUB(NOW(), INTERVAL 30 DAY)
      `);l=Number(t[0]?.count)||0,console.log("Recent heroes count:",l)}catch(e){console.log("Recent heroes query failed:",e.message)}t.status(200).json({totalHeroes:a,totalItems:s,totalMatches:n,totalTeams:r,recentHeroes:l,debug:{tables:o.map(e=>Object.values(e)[0]),timestamp:new Date().toISOString()}})}catch(e){console.error("Database connection error:",e),t.status(200).json({totalHeroes:0,totalItems:0,totalMatches:0,totalTeams:0,recentHeroes:0,message:"Database not available, showing default values"})}}let u=(0,r.l)(a,"default"),i=(0,r.l)(a,"config"),m=new s.PagesAPIRouteModule({definition:{kind:n.x.PAGES_API,page:"/api/stats",pathname:"/api/stats",bundlePath:"",filename:""},userland:a})},1004:(e,t,o)=>{let a;o.d(t,{I:()=>c,db:()=>r});var s=o(2418),n=o.n(s);async function r(){if(!a){let{DB_HOST:e="localhost",DB_NAME:t="",DB_USER:o="",DB_PASS:s="",DB_PORT:r="3306"}=process.env;try{a=n().createPool({host:e,port:Number(r),user:o,password:s,database:t,connectionLimit:10,charset:"utf8mb4_unicode_ci",acquireTimeout:6e4,timeout:6e4,enableKeepAlive:!0,keepAliveInitialDelay:0})}catch(e){throw console.error("Failed to create database pool:",e),Error("Database connection failed")}}return a}async function c(e,t=[]){try{let o=await r(),[a]=await o.execute(e,t);return a}catch(e){throw console.error("Database query failed:",e),e}}},7153:(e,t)=>{var o;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return o}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(o||(o={}))},1802:(e,t,o)=>{e.exports=o(145)}};var t=require("../../webpack-api-runtime.js");t.C(e);var o=t(t.s=2753);module.exports=o})();