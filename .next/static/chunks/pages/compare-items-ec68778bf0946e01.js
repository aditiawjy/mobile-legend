(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[162],{4670:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/compare-items",function(){return r(8702)}])},2812:function(e,t,r){"use strict";r.d(t,{L_:function(){return C},ql:function(){return _},nc:function(){return k}});var l=r(5068),a=r(7294),n=r(6658),s=r(503),i=r(46),o=r(1688);let c=()=>{},u=c(),d=Object,m=e=>e===u,x=e=>"function"==typeof e,h=new WeakMap,p=e=>d.prototype.toString.call(e),f=(e,t)=>e===`[object ${t}]`,g=0,v=e=>{let t,r;let l=typeof e,a=p(e),n=f(a,"Date"),s=f(a,"RegExp"),i=f(a,"Object");if(d(e)!==e||n||s)t=n?e.toJSON():"symbol"==l?e.toString():"string"==l?JSON.stringify(e):""+e;else{if(t=h.get(e))return t;if(t=++g+"~",h.set(e,t),Array.isArray(e)){for(r=0,t="@";r<e.length;r++)t+=v(e[r])+",";h.set(e,t)}if(i){t="#";let l=d.keys(e).sort();for(;!m(r=l.pop());)m(e[r])||(t+=r+":"+v(e[r])+",");h.set(e,t)}}return t},y=e=>{if(x(e))try{e=e()}catch(t){e=""}let t=e;return[e="string"==typeof e?e:(Array.isArray(e)?e.length:e)?v(e):"",t]},b=e=>y(e?e(0,null):null)[0],j=Promise.resolve(),N=(0,i.xD)(l.ZP,e=>(t,r,l)=>{let i;let c=(0,a.useRef)(!1),{cache:u,initialSize:d=1,revalidateAll:m=!1,persistSize:x=!1,revalidateFirstPage:h=!0,revalidateOnMount:p=!1,parallel:f=!1}=l,[,,,g]=n.b.get(n.c);try{(i=b(t))&&(i=s.U+i)}catch(e){}let[v,y,N]=(0,n.z)(u,i),w=(0,a.useCallback)(()=>(0,n.e)(v()._l)?d:v()._l,[u,i,d]);(0,o.useSyncExternalStore)((0,a.useCallback)(e=>i?N(i,()=>{e()}):()=>{},[u,i]),w,w);let k=(0,a.useCallback)(()=>{let e=v()._l;return(0,n.e)(e)?d:e},[i,d]),_=(0,a.useRef)(k());(0,n.u)(()=>{if(!c.current){c.current=!0;return}i&&y({_l:x?_.current:k()})},[i,u]);let C=p&&!c.current,S=e(i,async e=>{let a=v()._i,s=v()._r;y({_r:n.U});let i=[],o=k(),[c]=(0,n.z)(u,e),d=c().data,x=[],p=null;for(let e=0;e<o;++e){let[o,c]=(0,n.s)(t(e,f?null:p));if(!o)break;let[v,y]=(0,n.z)(u,o),b=v().data,j=m||a||(0,n.e)(b)||h&&!e&&!(0,n.e)(d)||C||d&&!(0,n.e)(d[e])&&!l.compare(d[e],b);if(r&&("function"==typeof s?s(b,c):j)){let t=async()=>{if(o in g){let e=g[o];delete g[o],b=await e}else b=await r(c);y({data:b,_k:c}),i[e]=b};f?x.push(t):await t()}else i[e]=b;f||(p=b)}return f&&await Promise.all(x.map(e=>e())),y({_i:n.U}),i},l),E=(0,a.useCallback)(function(e,t){let r="boolean"==typeof t?{revalidate:t}:t||{},l=!1!==r.revalidate;return i?(l&&((0,n.e)(e)?y({_i:!0,_r:r.revalidate}):y({_i:!1,_r:r.revalidate})),arguments.length?S.mutate(e,{...r,revalidate:l}):S.mutate()):j},[i,u]),D=(0,a.useCallback)(e=>{let r;if(!i)return j;let[,l]=(0,n.z)(u,i);if((0,n.a)(e)?r=e(k()):"number"==typeof e&&(r=e),"number"!=typeof r)return j;l({_l:r}),_.current=r;let a=[],[s]=(0,n.z)(u,i),o=null;for(let e=0;e<r;++e){let[r]=(0,n.s)(t(e,o)),[l]=(0,n.z)(u,r),i=r?l().data:n.U;if((0,n.e)(i))return E(s().data);a.push(i),o=i}return E(a)},[i,u,E,k]);return{size:k(),setSize:D,mutate:E,get data(){return S.data},get error(){return S.error},get isValidating(){return S.isValidating},get isLoading(){return S.isLoading}}}),w=async e=>{let t=await fetch(e);if(!t.ok){let e=Error("An error occurred while fetching the data.");throw e.info=await t.json(),e.status=t.status,e}return t.json()};function k(){var e,t,r,l,a;let n=!(arguments.length>0)||void 0===arguments[0]||arguments[0],s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{category:i="",sortBy:o="name",sortOrder:c="asc",minPrice:u=null,maxPrice:d=null,fetchAll:m=!1}=s,{data:x,error:h,size:p,setSize:f,isValidating:g,mutate:v}=N((e,t)=>{if(!n||m&&e>0||t&&!t.hasMore)return null;let r=new URLSearchParams({limit:"20",offset:(20*e).toString(),sortBy:o,sortOrder:c});return m&&r.append("fetchAll","true"),i&&r.append("category",i),null!==u&&r.append("minPrice",u.toString()),null!==d&&r.append("maxPrice",d.toString()),"/api/items?".concat(r.toString())},w,{revalidateFirstPage:!1,revalidateAll:!1,persistSize:!1}),y=x?x.flatMap(e=>e.items||[]):[],b=!!x&&(null===(e=x[x.length-1])||void 0===e?void 0:e.hasMore),j=!x&&!h,k=j||p>0&&x&&void 0===x[p-1],_=(null==x?void 0:null===(r=x[0])||void 0===r?void 0:null===(t=r.items)||void 0===t?void 0:t.length)===0,C=g&&x&&x.length===p;return{items:y,total:(null==x?void 0:null===(l=x[0])||void 0===l?void 0:l.total)||0,hasMore:b,isLoading:j,isLoadingMore:k,isRefreshing:C,isEmpty:_,error:h,loadMore:()=>f(p+1),refresh:v,activeFilters:(null==x?void 0:null===(a=x[0])||void 0===a?void 0:a.filters)||{},size:p}}function _(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];let{data:t,error:r,isValidating:a}=(0,l.ZP)(e&&e.trim()?"/api/items_search?q=".concat(encodeURIComponent(e)):null,w,{dedupingInterval:1e3,revalidateOnFocus:!1});return{suggestions:Array.isArray(t)?t:[],isLoading:a,error:r}}function C(){let{data:e,error:t,isValidating:r}=(0,l.ZP)("/api/items/categories",w,{revalidateOnFocus:!1,dedupingInterval:6e4});return{categories:(null==e?void 0:e.categories)||[],isLoading:!e&&!t,error:t}}},8702:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return u}});var l=r(5893),a=r(7294),n=r(1163),s=r(2255),i=r(8439),o=r(7134),c=r(2812);function u(){let e=(0,n.useRouter)(),{addToast:t}=(0,i.pm)(),[r,u]=(0,a.useState)([null,null,null]),[m,x]=(0,a.useState)([null,null,null]),[h,p]=(0,a.useState)([!1,!1,!1]),[f,g]=(0,a.useState)(["","",""]),[v,y]=(0,a.useState)(-1),[b,j]=(0,a.useState)(-1),N=[(0,a.useRef)(null),(0,a.useRef)(null),(0,a.useRef)(null)],w=[(0,a.useRef)(null),(0,a.useRef)(null),(0,a.useRef)(null)],k=function(e,t){let[r,l]=(0,a.useState)(e);return(0,a.useEffect)(()=>{let t=setTimeout(()=>l(e),300);return()=>clearTimeout(t)},[e,300]),r}(v>=0?f[v]:"",300),{suggestions:_,isLoading:C}=(0,c.ql)(k);(0,a.useEffect)(()=>{let{item1:t,item2:l,item3:a}=e.query,n=[t,l,a],s=n.some(Boolean),i=r.some(Boolean);s&&!i&&e.isReady&&n.forEach((e,t)=>{e&&t<3&&!r[t]&&S(t,e)})},[e.isReady]);let S=async(e,r)=>{if(r){u(t=>{let l=[...t];return l[e]=r,l}),g(t=>{let l=[...t];return l[e]=r,l}),p(t=>{let r=[...t];return r[e]=!0,r});try{let t=await fetch("/api/items/".concat(encodeURIComponent(r)));if(!t.ok)throw Error("Item not found");let l=await t.json();x(t=>{let r=[...t];return r[e]=l,r})}catch(l){t((0,i._N)("Gagal memuat item: ".concat(r),"Error")),x(t=>{let r=[...t];return r[e]=null,r})}finally{p(t=>{let r=[...t];return r[e]=!1,r})}}};(0,a.useEffect)(()=>{let e=e=>{if(b>=0){let t=w[b].current,r=N[b].current;t&&!t.contains(e.target)&&e.target!==r&&j(-1)}};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[b]);let E=async(e,l)=>{if(!l)return;let a=[...r];a[e]=l,u(a);let n=[...f];n[e]=l,g(n),j(-1),y(-1),p(t=>{let r=[...t];return r[e]=!0,r});try{let t=await fetch("/api/items/".concat(encodeURIComponent(l)));if(!t.ok)throw Error("Item not found");let r=await t.json();x(t=>{let l=[...t];return l[e]=r,l})}catch(r){t((0,i._N)("Gagal memuat item: ".concat(l),"Error")),x(t=>{let r=[...t];return r[e]=null,r})}finally{p(t=>{let r=[...t];return r[e]=!1,r})}L(a)},D=e=>{u(t=>{let r=[...t];return r[e]=null,L(r),r}),x(t=>{let r=[...t];return r[e]=null,r}),g(t=>{let r=[...t];return r[e]="",r}),p(t=>{let r=[...t];return r[e]=!1,r})},L=t=>{let r=new URLSearchParams;t.forEach((e,t)=>{e&&r.append("item".concat(t+1),e)}),e.replace("/compare-items?".concat(r.toString()),void 0,{shallow:!0})},R=(e,t)=>{let r=[...f];r[e]=t,g(r),y(e),j(e)},P=(e,t)=>{"Escape"===t.key&&(j(-1),y(-1))},A=m.filter(Boolean),I=A.length>=2;return(0,l.jsx)(s.Z,{children:(0,l.jsx)("div",{className:"bg-gradient-to-br from-purple-50 via-white to-blue-50 min-h-screen",children:(0,l.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[(0,l.jsx)("header",{className:"mb-8",children:(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("h1",{className:"text-3xl md:text-4xl font-bold text-gray-800 flex items-center gap-3",children:[(0,l.jsx)("span",{className:"text-purple-600",children:"⚖️"})," Compare Items"]}),(0,l.jsx)("p",{className:"text-gray-600 mt-2",children:"Bandingkan 2-3 items untuk melihat perbedaan stats dan harga"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("button",{onClick:()=>e.push("/items?showAll=true"),className:"text-sm px-3 py-1.5 rounded-md border border-gray-200 text-gray-700 bg-white hover:bg-gray-100",children:"Browse Items"}),(0,l.jsx)("button",{onClick:()=>e.push("/"),className:"text-sm px-3 py-1.5 rounded-md border border-gray-200 text-gray-700 bg-white hover:bg-gray-100",children:"Home"})]})]})}),(0,l.jsxs)("section",{className:"bg-white rounded-2xl shadow border border-gray-100 p-6 mb-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold text-gray-800",children:"Pilih Items untuk Dibandingkan"}),A.length>0&&(0,l.jsx)("button",{onClick:()=>{u([null,null,null]),x([null,null,null]),g(["","",""]),e.replace("/compare-items",void 0,{shallow:!0})},className:"text-sm text-red-600 hover:text-red-700 font-medium",children:"Clear All"})]}),(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[0,1,2].map(e=>{var t,a;return(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Item ",e+1," ",0===e&&(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),r[e]?(0,l.jsxs)("div",{className:"border-2 border-purple-200 rounded-lg p-4 bg-purple-50",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(o.Z,{src:null===(t=m[e])||void 0===t?void 0:t.image_url,alt:r[e],containerClassName:"w-10 h-10",className:"w-full h-full object-cover rounded-full"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-semibold text-gray-900 text-sm",children:r[e]}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:(null===(a=m[e])||void 0===a?void 0:a.category)||"Loading..."})]})]}),(0,l.jsx)("button",{onClick:()=>D(e),className:"text-red-500 hover:text-red-700",children:(0,l.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),h[e]&&(0,l.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-purple-600"}),"Loading details..."]})]}):(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("input",{ref:N[e],type:"text",value:f[e],onChange:t=>R(e,t.target.value),onKeyDown:t=>P(e,t),onFocus:()=>{y(e),f[e]&&j(e)},placeholder:"Ketik nama item...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),b===e&&v===e&&(_.length>0||C)&&(0,l.jsx)("div",{ref:w[e],className:"absolute z-10 mt-2 w-full bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-auto",children:C?(0,l.jsxs)("div",{className:"flex items-center justify-center py-4 px-4",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-purple-600"}),(0,l.jsx)("span",{className:"ml-2 text-sm text-gray-600",children:"Mencari..."})]}):_.map((t,r)=>(0,l.jsx)("div",{className:"cursor-pointer px-4 py-2 text-sm text-gray-700 hover:bg-purple-50",onMouseDown:r=>{r.preventDefault(),E(e,t)},children:t},t+r))})]})]},e)})}),!I&&(0,l.jsx)("p",{className:"text-sm text-gray-500 mt-4 text-center",children:"Pilih minimal 2 items untuk mulai membandingkan"})]}),I&&(0,l.jsx)("section",{className:"bg-white rounded-2xl shadow border border-gray-100 overflow-hidden",children:(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full",children:[(0,l.jsx)("thead",{className:"bg-gradient-to-r from-purple-100 to-blue-100",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-700 w-1/4",children:"Attribute"}),A.map((e,t)=>(0,l.jsx)("th",{className:"px-6 py-4 text-center text-sm font-semibold text-gray-700",children:(0,l.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,l.jsx)(o.Z,{src:e.image_url,alt:e.item_name,containerClassName:"w-16 h-16",className:"w-full h-full object-cover rounded-full"}),(0,l.jsx)("span",{className:"font-bold",children:e.item_name}),(0,l.jsx)("span",{className:"text-xs text-gray-500 font-normal",children:e.category})]})},t))]})}),(0,l.jsxs)("tbody",{className:"divide-y divide-gray-200",children:[(0,l.jsx)(d,{label:"Price",icon:"\uD83D\uDCB0",values:A.map(e=>({value:e.price,display:null!==e.price&&void 0!==e.price?"".concat(e.price.toLocaleString()," gold"):"N/A"})),highlightLowest:!0}),(0,l.jsx)(d,{label:"Category",icon:"\uD83D\uDCE6",values:A.map(e=>({value:e.category,display:e.category||"N/A"}))}),(0,l.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,l.jsx)("td",{className:"px-6 py-4 text-sm font-medium text-gray-700",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{children:"\uD83D\uDCDD"}),(0,l.jsx)("span",{children:"Description"})]})}),A.map((e,t)=>(0,l.jsx)("td",{className:"px-6 py-4 text-sm text-gray-600 text-center",children:(0,l.jsx)("div",{className:"max-w-xs mx-auto text-left",children:e.description||"No description available"})},t))]})]})]})})}),(0,l.jsxs)("footer",{className:"mt-10 text-center text-xs text-gray-400",children:[new Date().getFullYear()," ML Helper"]})]})})})}function d(e){let{label:t,icon:r,values:a,highlightLowest:n=!1}=e,s=-1;if(n){let e=a.map(e=>"number"==typeof e.value?e.value:1/0),t=Math.min(...e);t!==1/0&&(s=e.indexOf(t))}return(0,l.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,l.jsx)("td",{className:"px-6 py-4 text-sm font-medium text-gray-700",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("span",{children:r}),(0,l.jsx)("span",{children:t})]})}),a.map((e,t)=>(0,l.jsxs)("td",{className:"px-6 py-4 text-sm text-center font-medium ".concat(t===s?"text-green-700 bg-green-50":"text-gray-600"),children:[e.display,t===s&&n&&(0,l.jsx)("span",{className:"ml-2 text-xs",children:"✓ Best"})]},t))]})}}},function(e){e.O(0,[424,42,888,774,179],function(){return e(e.s=4670)}),_N_E=e.O()}]);