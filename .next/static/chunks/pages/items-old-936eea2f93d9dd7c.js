(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[49],{8912:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/items-old",function(){return r(184)}])},184:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var a=r(5893),s=r(7294),n=r(1163),l=r(2255),i=r(8439),c=r(7134);function d(){let e=(0,n.useRouter)(),{addToast:t}=(0,i.pm)(),[r,d]=(0,s.useState)(""),[o,m]=(0,s.useState)([]),[x,u]=(0,s.useState)(!1),[h,g]=(0,s.useState)(-1),[p,b]=(0,s.useState)(null),f=(0,s.useRef)(null),y=(0,s.useRef)(null),j=function(e,t){let[r,a]=(0,s.useState)(e);return(0,s.useEffect)(()=>{let t=setTimeout(()=>a(e),200);return()=>clearTimeout(t)},[e,200]),r}(r,200),N="true"===e.query.showAll,[w,v]=(0,s.useState)([]),[k,_]=(0,s.useState)(!1),[E,C]=(0,s.useState)(!0),[S,I]=(0,s.useState)(0),[M,D]=(0,s.useState)(!1),R=(0,s.useRef)(null);(0,s.useEffect)(()=>{let e=!1;return(async()=>{if(!j){m([]),u(!1);return}u(!0);try{let t=await fetch("/api/items_search?q=".concat(encodeURIComponent(j)));if(!t.ok)throw Error("Network error");let r=await t.json();e||(m(Array.isArray(r)?r:[]),u(!1))}catch(r){console.error(r),e||(u(!1),t((0,i._N)("Gagal mencari items. Silakan coba lagi.","Network Error")))}})(),()=>{e=!0}},[j]),(0,s.useEffect)(()=>{(async()=>{if(!N){v([]),I(0),C(!0);return}_(!0);try{let e=await fetch("/api/items?limit=20&offset=0");if(e.ok){let t=await e.json();v(t.items||[]),C(t.hasMore),I(20)}}catch(e){console.error(e),v([]),t((0,i._N)("Gagal memuat daftar items. Silakan refresh halaman.","Network Error"))}finally{_(!1)}})()},[N,t]);let A=t=>{t&&(d(t),m([]),u(!1),e.push("/item/".concat(encodeURIComponent(t))))};(0,s.useEffect)(()=>{let e=e=>{f.current&&!f.current.contains(e.target)&&e.target!==y.current&&m([])};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[]);let L=(0,s.useCallback)(async()=>{if(!M&&E){D(!0);try{let e=await fetch("/api/items?limit=20&offset=".concat(S));if(e.ok){let t=await e.json();v(e=>[...e,...t.items||[]]),C(t.hasMore),I(e=>e+20)}}catch(e){console.error(e),t((0,i._N)("Gagal memuat lebih banyak items.","Network Error"))}finally{D(!1)}}},[M,E,S,t]);return(0,s.useEffect)(()=>{if(!N||!R.current)return;let e=R.current,t=new IntersectionObserver(e=>{e[0].isIntersecting&&E&&!M&&L()},{threshold:.1});return t.observe(e),()=>{e&&t.unobserve(e)}},[N,E,M,L]),(0,a.jsx)(l.Z,{children:(0,a.jsx)("div",{className:"bg-gradient-to-br from-blue-50 via-white to-green-50 min-h-screen",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[(0,a.jsxs)("header",{className:"mb-8 flex items-start justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-3xl md:text-4xl font-bold text-gray-800 flex items-center gap-3",children:[(0,a.jsx)("span",{className:"text-green-600",children:"ML"})," Items",N&&(0,a.jsx)("span",{className:"text-lg font-normal text-gray-500",children:"- All Items"})]}),(0,a.jsx)("p",{className:"text-gray-600 mt-2",children:N?"Menampilkan semua ".concat(w.length," items dari database."):"Cari item Mobile Legends dan lihat detailnya secara instan."})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("a",{href:"/?showAll=true",className:"text-sm inline-flex items-center gap-1 px-3 py-1.5 rounded-md border border-gray-200 text-gray-700 bg-white hover:bg-gray-100",children:"Heroes"}),(0,a.jsx)("a",{href:"/edit-matches",className:"text-sm inline-flex items-center gap-1 px-3 py-1.5 rounded-md border border-gray-200 text-gray-700 bg-white hover:bg-gray-100",children:"Matches"}),(0,a.jsx)("a",{href:"/",className:"text-sm inline-flex items-center gap-1 px-3 py-1.5 rounded-md border border-gray-200 text-gray-700 bg-white hover:bg-gray-100",children:N?"Dashboard":"Home"}),N&&(0,a.jsx)("button",{onClick:()=>e.push("/items"),className:"text-sm inline-flex items-center gap-1 px-3 py-1.5 rounded-md border border-gray-200 text-gray-700 bg-white hover:bg-gray-100",children:"Kembali ke Search Items"})]})]}),!N&&(0,a.jsxs)("section",{className:"bg-white rounded-2xl shadow border border-gray-100 p-4 md:p-6",children:[(0,a.jsx)("label",{htmlFor:"itemInput",className:"block text-sm font-medium text-gray-700 mb-2",children:"Cari Item"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{id:"itemInput",ref:y,value:r,onChange:e=>{d(e.target.value),g(-1)},onKeyDown:e=>{if(o.length||x)switch(e.key){case"ArrowDown":x||(e.preventDefault(),g(e=>(e+1)%o.length));break;case"ArrowUp":x||(e.preventDefault(),g(e=>(e-1+o.length)%o.length));break;case"Enter":!x&&(h>=0?(e.preventDefault(),A(o[h])):r.trim()&&A(r.trim()));break;case"Escape":m([]),u(!1)}},placeholder:"Ketik nama item...",className:"w-full rounded-none border border-black bg-white focus:border-black focus:ring-black pr-10 px-3 py-2 rounded-xs",autoComplete:"off"}),(o.length>0||x)&&(0,a.jsx)("div",{ref:f,className:"absolute z-10 mt-2 w-full bg-white border border-gray-200 rounded-xl shadow-lg max-h-72 overflow-auto",children:x?(0,a.jsxs)("div",{className:"flex items-center justify-center py-4 px-4",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-green-600"}),(0,a.jsx)("span",{className:"ml-2 text-sm text-gray-600",children:"Mencari items..."})]}):o.map((e,t)=>(0,a.jsx)("div",{className:"cursor-pointer px-4 py-2 text-sm text-gray-700 ".concat(0===t?"rounded-t-xl":""," ").concat(t===o.length-1?"rounded-b-xl":""," ").concat(t===h?"bg-gray-100":""),onMouseDown:t=>{t.preventDefault(),A(e)},children:e},e+t))})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"Mulai ketik minimal 1 huruf. Gunakan tombol panah untuk navigasi dan Enter untuk pilih."})]}),N&&(0,a.jsx)("section",{className:"bg-white rounded-2xl shadow border border-gray-100 p-4 md:p-6",children:k?(0,a.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-sky-600"}),(0,a.jsx)("span",{className:"ml-2 text-gray-600",children:"Memuat items..."})]}):w.length>0?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:w.map((t,r)=>(0,a.jsx)("div",{className:"bg-gray-50 rounded-lg p-4 hover:bg-gray-100 transition-colors cursor-pointer border border-gray-200",onClick:()=>e.push("/item/".concat(encodeURIComponent(t.item_name))),children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(c.Z,{src:t.image_url,alt:t.item_name,containerClassName:"w-16 h-16 mx-auto mb-3",className:"w-full h-full object-cover rounded-full"}),(0,a.jsx)("h3",{className:"font-semibold text-gray-900 text-sm mb-1",children:t.item_name}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:t.category||"Item"})]})},r))}),(0,a.jsxs)("div",{ref:R,className:"mt-8 flex flex-col items-center justify-center py-4",children:[M&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"}),(0,a.jsx)("span",{className:"mt-2 text-sm text-gray-600",children:"Memuat lebih banyak items..."})]}),!E&&(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:["âœ“ Semua ",w.length," items telah dimuat"]})]})]}):(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("p",{className:"text-gray-600",children:"Tidak ada items ditemukan di database."})})}),p&&(0,a.jsx)("section",{className:"mt-8",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow border border-gray-100 p-4 md:p-6",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:p.item_name||r}),p.category&&(0,a.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Category: ",p.category]})]}),(0,a.jsx)("a",{href:"/edit-items?name=".concat(encodeURIComponent(p.item_name||r)),className:"text-xs inline-flex items-center gap-1 px-3 py-1.5 rounded-md border border-gray-200 text-gray-700 bg-white hover:bg-gray-100",children:"Edit Item"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6 mt-6",children:[(0,a.jsx)("div",{className:"space-y-3",children:(0,a.jsxs)("div",{className:"p-4 bg-gray-50 rounded-xl",children:[(0,a.jsx)("p",{className:"text-xs font-semibold text-gray-500 uppercase",children:"Description"}),(0,a.jsx)("p",{className:"text-gray-700 mt-1",children:p.description||"-"})]})}),(0,a.jsx)("div",{className:"space-y-3",children:(0,a.jsxs)("div",{className:"p-4 bg-gray-50 rounded-xl",children:[(0,a.jsx)("p",{className:"text-xs font-semibold text-gray-500 uppercase",children:"Price"}),(0,a.jsx)("p",{className:"text-gray-700 mt-1",children:null!=p.price?"".concat(p.price," gold"):"-"})]})})]})]})}),(0,a.jsxs)("footer",{className:"mt-10 text-center text-xs text-gray-400",children:[new Date().getFullYear()," ML Helper"]})]})})})}}},function(e){e.O(0,[424,42,888,774,179],function(){return e(e.s=8912)}),_N_E=e.O()}]);